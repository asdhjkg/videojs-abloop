!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(this,e,e.videojs)):"undefined"!=typeof module&&module.exports?module.exports=t(e,e.videojs):t(e,e.videojs)}(window,function(q,H){"use strict";function e(n){function a(e){return!isNaN(parseFloat(e))&&isFinite(e)}function e(e){return e&&"[object Function]"==={}.toString.call(e)}function t(e){return!!e}function o(e,t){return t=t||1,H.formatTime(e)+"."+Math.floor(e%1*Math.pow(10,t))}function r(e,t){var n=Math.pow(10,t);return Math.floor(e*n)/n}function i(e){if(void 0!==e){if(a(e))return e;if(/^([+\-])?([\d\.]+)$/i.test(e))return parseFloat(e);var t=/^([+\-])?((([\d]+)(h|:(?=.*:)))?(([\d]+)(m|:|$))?)?(([\d\.]+)s?)?$/i.exec(e);if(!t)return null;var n={match:t[0],sign:t[1],hours:t[4]||0,mins:t[7]||0,secs:t[10]||0},o="-"==n.sign?-1:1,r=60*parseFloat(n.hours)*60+60*parseFloat(n.mins)+parseFloat(n.secs);return a(r)?o*r:null}}function u(){function e(t){return function(e){void 0===n[e]&&(n[e]=t[e].default)}}n=n||{},O.forEach(e(A)),k.forEach(e(B))}function f(){return O.forEach(function(e){E[e]=A[e].validate(E[e])}),D}function c(){return S(n,!0)}function l(e){return e?E.pauseBeforeLooping&&!1===P?(U.pause(),P=!0):(P=!1,U.currentTime(E.start),E.pauseAfterLooping&&U.pause(),B.onLoopCallBack.check(D.onLoopCallBack)&&D.onLoopCallBack(D,U)):(P=!1,U.currentTime(E.start)),D}function p(t){return function(e){return!1===e?E[t]=!1:(void 0!==e&&(e=i(e)),null!==e&&(e=void 0===e?U.currentTime():e,E[t]=e)),D}}function s(t){return function(e){return e=i(e),a(e)&&(E[t]+=e),D}}function d(e){return function(){return E[e]=!E[e],D}}function g(e){(e=e||{}).decimalPlaces=Math.floor(e.decimalPlaces)||3;var t=!1!==E.start?parseFloat(E.start):0,n="#t="+r(t,e.decimalPlaces);if(!1!==E.end){var o=parseFloat(E.end);n+=","+r(o,e.decimalPlaces)}return n}function h(e){if("string"==typeof e&&(e=H.parseUrl(e)),e.hash){var t=/^(#?t=)?([^,]*)(,(.*))?$/,n=e.hash.replace(t,"$2"),o=e.hash.replace(t,"$4");n=i(n),o=i(o),a(n)&&(E.start=parseFloat(n)),a(o)&&(E.end=parseFloat(o))}return D}function L(e){var t,n,o=e;return"string"==typeof e?o=[e]:void 0!==e&&Array.isArray(e)||(o=null!==e&&"object"==typeof e?Object.keys(e):Object.keys(A)),t=E,n={},o.forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n}function v(r,a){var t=!a;return a=a||{},O.forEach(function(e){a[e]=!!a[e]||t}),function(){var e=arguments,t=L(),n=r.apply(null,e),o={changed:a,oldOpts:t,newOpts:L()};return D.onOptionsChange&&D.onOptionsChange(o,D,U),N(a),n}}function m(){var e,t,n;if(f(),e=U.currentTime(),(t=C())<(n=j())){if(x=!0,e<n-.5&&t<e&&(e-t<1||E.loopIfAfterEnd||E.loopIfBeforeStart))return!0}else{if(x=!1,e<n-.5&&E.loopIfBeforeStart)return!0;if(t<=e&&(e-t<1||E.loopIfAfterEnd))return!0}return!1}function y(e){!K&&E.enabled&&!U.paused()&&m()&&(K=!0,setTimeout(function(){K=!1},w),l(!0))}function b(e,o){function t(t,n){return function(e){(void 0===n||e.which&&e.which==n)&&(t(o.abLoopPlugin,e),this.updateText())}}var n,r,a=o.controlBar.addChild("Button");return e.leftclick&&a.on("click",t(e.leftclick)),e.rightclick&&(a.el().onmousedown=t(e.rightclick,3).bind(a),a.on("contextmenu",function(e){return e.preventDefault&&e.preventDefault(),e.preventDefault&&e.stopPropagation(),!1})),a.updateText=(n=e.defaultText,r=e.textFunction,function(){var e=r(E)||n;this.el().textContent=e}),a.optionsUsed=e.optionsUsed,a.addClass("abLoopButton"),a.addClass(e.name),a.updateText(),a}n=n||{};var U=this,E={},A={start:{default:0,validate:function(e){return!1===e||a(e)&&0<=e?e:0}},end:{default:!1,validate:function(e){if(!1===e)return e;if(a(e)){var t=U.duration();if(0!==t&&a(t))return 0<=e&&e<=t?e:t<e?t:e;if(0<=e)return e}return!1}},enabled:{default:!1,validate:t},loopIfBeforeStart:{default:!0,validate:t},loopIfAfterEnd:{default:!0,validate:t},pauseBeforeLooping:{default:!1,validate:t},pauseAfterLooping:{default:!1,validate:t}},B={onLoopCallBack:{default:void 0,check:e},onOptionsChange:{default:void 0,check:e}},O=Object.keys(A),k=Object.keys(B),S=function(t,n){return O.forEach(function(e){!n&&void 0===t[e]||(E[e]=t[e])}),f(),D},P=!1,T=function(){return E.enabled=!0,D},F=function(e){e=e||{};var t=U.currentSrc();return t.src&&(t=t.src),t+g(e)},x=!1,j=function(){return!1===E.start?0:E.start},C=function(){return!1===E.end?U.duration():E.end},K=!1,w=a(n.minLoopLength)&&0<n.minLoopLength?n.minLoopLength:200,$={},I=[{name:"start",optionsUsed:["start"],leftclick:function(e,t){t.shiftKey?e.adjustStart(-.5):e.setStart()},rightclick:function(e,t){t.shiftKey?e.adjustStart(.5):e.goToStart()},defaultText:"Start",textFunction:function(e){return o(e.start)}},{name:"end",optionsUsed:["end"],leftclick:function(e,t){t.shiftKey?e.adjustEnd(-.5):t.ctrlKey?e.adjustEnd(-.05):e.setEnd()},rightclick:function(e,t){t.shiftKey?e.adjustEnd(.5):t.ctrlKey?e.adjustEnd(.05):e.goToEnd()},defaultText:"End",textFunction:function(e){return o(e.end)}},{name:"enabled",optionsUsed:["enabled","pauseAfterLooping","pauseBeforeLooping"],leftclick:function(e,t){q&&q.prompt?t.ctrlKey?e.applyUrl(R("Set new URL",e.getAbsoluteUrl())):t.altKey?e.applyUrl(R("Set new URL",e.getUrl())):t.shiftKey?e.applyUrlFragment(R("Set new URL fragment",e.getUrlFragment())):e.toggle():e.toggle()},rightclick:function(e,t){var n;q&&q.prompt&&(t.ctrlKey?n=e.getAbsoluteUrl():t.altKey?n=e.getUrl():t.shiftKey&&(n=e.getUrlFragment())),n?M(n):e.cyclePauseOnLooping()},defaultText:"Loop",textFunction:function(e){return e.enabled?e.pauseBeforeLooping&&e.pauseAfterLooping?"PAUSE LOOP PAUSE":e.pauseAfterLooping?"LOOP& PAUSE":e.pauseBeforeLooping?"PAUSE &LOOP":"LOOP ON":"Loop off"}}],M=function(e){q&&q.prompt&&q.prompt("Copy to clipboard: Ctrl+C, Enter",e)},R=function(e,t){return!(!q||!q.prompt)&&q.prompt(e,t)},N=function(n){function e(e,t){return e||n[t]}for(var t in $){var o=$[t];(!o.optionsUsed||o.optionsUsed.reduce(e,!1))&&o.updateText()}},D={validateOptions:v(f),resetToInitialOptions:v(c),setOptions:v(S),getOptions:L,goToStart:l,goToEnd:function(){return P=!1,U.currentTime(E.end),D},setStart:v(p("start"),{start:!0}),setEnd:v(p("end"),{end:!0}),adjustStart:v(s("start"),{start:!0}),adjustEnd:v(s("end"),{end:!0}),enable:v(T,{enabled:!0}),disable:v(function(){return E.enabled=!1,D},{enabled:!0}),toggle:v(d("enabled"),{enabled:!0}),togglePauseAfterLooping:v(d("pauseAfterLooping"),{pauseAfterLooping:!0}),togglePauseBeforeLooping:v(d("pauseBeforeLooping"),{pauseBeforeLooping:!0}),cyclePauseOnLooping:v(function(){var e=E.pauseAfterLooping,t=E.pauseBeforeLooping;return S(e||t?e&&!t?{pauseAfterLooping:!1,pauseBeforeLooping:!0}:!e&&t?{pauseAfterLooping:!0,pauseBeforeLooping:!0}:{pauseAfterLooping:!1,pauseBeforeLooping:!1}:{pauseAfterLooping:!0,pauseBeforeLooping:!1}),D},{pauseBeforeLooping:!0,pauseAfterLooping:!0}),player:U,version:V,getAbsoluteUrl:function(e){return function(e){if(!e.match(/^https?:\/\//)&&q&&q.document){var t=q.document.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e}(F(e))},getUrl:F,getUrlFragment:g,applyUrl:v(function(e){var t=e.replace(/^(.*?)(#.*)?$/,"$1"),n=e.replace(/^(.*?)(#.*)?$/,"$2"),o=U.currentSrc();return o!=t&&o!=e&&e!=n&&U.src(t),n&&h(n),D},{start:!0,end:!0}),applyUrlFragment:v(h,{start:!0,end:!0}),loopRequired:m,playLoop:v(function(){return f(),l(!1),T(),U.play(),D})};return u(),k.forEach(function(e){B[e].check(n[e])&&(D[e]=n[e])}),v(c)(),U.ready(function(){0!=n.createButtons&&I.forEach(function(e){void 0===$[e.name]&&($[e.name]=b(e,U))}),U.on("ended",function(){x&&E.enabled&&!U.loop()&&U.play()})}),U.abLoopPlugin=D,U.on("timeupdate",y),D.loaded=!0,D}var V="1.0.2";return e.loaded=!1,e.VERSION=V,(H.registerPlugin||H.plugin)("abLoopPlugin",e)});